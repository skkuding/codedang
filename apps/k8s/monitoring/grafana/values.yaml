# check default values.yaml
# https://artifacthub.io/packages/helm/grafana/grafana?modal=values

replicas: 1
autoscaling:
  enabled: false

ingress:
  enabled: true
  path: /
  pathType: Prefix
  hosts:
    - grafana-test.codedang.com # TODO: update with actual host

limits:
  cpu: 200m
  memory: 256Mi
requests:
  cpu: 200m
  memory: 256Mi

# https://kubernetes.io/docs/concepts/storage/persistent-volumes/
# in the beginning of grafana migration, we allow editing dashboards without provisioning
# however, it is highly recommended to provision data as code
persistence:
  type: pvc
  enabled: true
  size: 10Gi

admin:
  existingSecret: grafana-admin-user
  userKey: ADMIN_USER
  passwordKey: ADMIN_PASSWORD

datasources:
  datasources.yaml:
    apiVersion: 1
    deleteDatasources: # auto delete if not provisioned
      - name: Loki-production
        orgId: 1
    prune: true
    datasources:
      - name: Loki-production
        type: loki
        access: proxy
        url: http://loki.monitoring-loki.svc.cluster.local:3100
        editable: true # TODO: set false after testing
        jsonData:
          httpHeaderName1: 'X-Scope-OrgID'
        secureJsonData:
          httpHeaderValue1: '1'
      - name: Prometheus-production
        type: prometheus
        access: proxy
        url: http://prometheus-kube-prometheus-prometheus.monitoring-prometheus.svc.cluster.local:9090
        editable: true # TODO: set false after testing

# help grafana to detect provisioned dashboards
sidecar:
  dashboards:
    enabled: true
    label: grafana_dashboard
    labelValue: '1'

# TODO: provision dashboard config maps
# dashboardsConfigMaps:
#   default: 'all-service-logs'
#   hardware: 'hardware-metrics'
#   submission: 'submission-detail'

# TODO: add public dashboards from https://grafana.com/grafana/dashboards/
downloadDashboards:
  env: {}

# Grafana's primary configuration
# http://docs.grafana.org/installation/configuration/
grafana.ini:
  log:
    mode: console
  server:
    domain: 'grafana-test.codedang.com' # TODO: update with actual host
    root_url: 'https://grafana-test.codedang.com' # TODO: update with actual host
