apiVersion: apps/v1
kind: Deployment
metadata:
  name: frontend
  namespace: frontend
spec:
  replicas: 1
  selector:
    matchLabels:
      app: frontend
  template:
    metadata:
      labels:
        app: frontend
    spec:
      containers:
        - name: frontend
          image: ghcr.io/skkuding/codedang-frontend:latest
          ports:
            - containerPort: 5525
          resources:
            limits:
              cpu: 1
              memory: 2Gi
            requests:
              cpu: 1
              memory: 2Gi
          env:
            - name: APP_ENV
              value: 'production'
            - name: NEXTAUTH_SECRET
              valueFrom:
                secretKeyRef:
                  name: frontend-secrets
                  key: NEXTAUTH_SECRET
            - name: NEXTAUTH_URL
              value: 'https://codedang.com/next-auth/api/auth'
            - name: NEXT_PUBLIC_BASEURL
              value: 'https://codedang.com/api'
            - name: NEXT_PUBLIC_CHANNEL_PLUGIN_KEY
              value: '2f5b48ae-a587-431f-8106-2842c4403bc7'
            - name: NEXT_PUBLIC_GQL_BASEURL
              value: 'https://codedang.com/graphql'
            - name: NEXT_PUBLIC_RUNNER_BASEURL
              value: 'wss://run.codedang.com/run'
