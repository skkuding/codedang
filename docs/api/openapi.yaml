openapi: 3.1.0
info:
  version: 0.1.0
  title: Codedang Client API
  summary: REST API for Codedang Client
  description: |
    ## ğŸˆ Overview
    Codedang is an online judge for students to practice their coding skills.
    Codedang client API can be used by general users.
servers:
  - url: https://dev.codedang.com/api
    description: Development server
  - url: https://codedang.com/api
    description: Production server
  - url: http://localhost:4000
    description: Local server
tags:
  - name: auth
  - name: user
  - name: group
  - name: problem
  - name: contest
  - name: submission
  - name: notice
  - name: workbook
paths:
  /auth/login:
    post:
      summary: Log In
      tags:
        - auth
      description: |
        ì‚¬ìš©ìê°€ ì˜¬ë°”ë¥¸ ì •ë³´ë¡œ ë¡œê·¸ì¸í•˜ë©´ JWTë¥¼ ë°œí–‰í•©ë‹ˆë‹¤.
        ë³´ì•ˆì„ ìœ„í•´ ë§Œë£Œ ì‹œê°„ì´ ì§§ì€ access tokenê³¼, ì´ í† í°ì˜ ì¬ë°œí–‰ì— ì‚¬ìš©í•  ë§Œë£Œ ì‹œê°„ì´ ê¸´ refresh tokenì„ ë°œí–‰í•©ë‹ˆë‹¤.

        ### Access Token
        - `Authorization` headerë¥¼ í†µí•´ bearer tokenì„ ë°œê¸‰í•©ë‹ˆë‹¤.
        - Headerë¡œ ë°œê¸‰ë˜ê¸° ë•Œë¬¸ì—, clientì— tokenì„ ì§ì ‘ ì €ì¥í•˜ëŠ” ì½”ë“œê°€ í•„ìš”í•©ë‹ˆë‹¤.
        - 30ë¶„ í›„ ë§Œë£Œë©ë‹ˆë‹¤.

        ### Refresh Token
        - Cookieë¥¼ í†µí•´ ë°œê¸‰ë˜ì–´ ë¸Œë¼ìš°ì €ì— ìë™ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.
        - `/auth/reissue`ë¥¼ í†µí•´ access tokenì„ ì¬ë°œí–‰í•  ë•Œ í•„ìš”í•©ë‹ˆë‹¤.
        - **ê°€ì¥ ìœ ì¶œì— ì¡°ì‹¬í•´ì•¼ í•˜ëŠ” ê°’ì…ë‹ˆë‹¤.**
        - 24ì‹œê°„ í›„ ë§Œë£Œë©ë‹ˆë‹¤.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginUserDto'
      responses:
        '201':
          description: Succeed
        '400':
          description: Bad Request; Username/Password should not be empty
        '401':
          description: Unauthorized; Incorrect username or password
  /auth/logout:
    post:
      summary: Log Out
      tags:
        - auth
      description: |
        Refresh tokenì„ ë¬´íš¨í™”í•˜ê³  cookieì—ì„œ ì‚­ì œí•©ë‹ˆë‹¤.
        Access tokenì€ ë§Œë£Œ ì „ê¹Œì§€ ìœ íš¨í•˜ë©°, clientì—ì„œ ì§ì ‘ ì‚­ì œí•´ì•¼ í•©ë‹ˆë‹¤.
      security:
        - bearer: []
      responses:
        '201':
          description: Succeed
        '401':
          description: Unauthorized
            (ë¡œê·¸ì¸ë˜ì–´ ìˆì§€ ì•Šì€ ìœ ì €ì˜ ë¡œê·¸ì•„ì›ƒ ì‹œë„)
  /auth/reissue:
    get:
      summary: Reissue Access Token
      tags:
        - auth
      description: |
        Refresh tokenì„ ì´ìš©í•´ access tokenì„ ì¬ë°œê¸‰í•©ë‹ˆë‹¤.
      security:
        - bearer: []
      responses:
        '200':
          description: Succeed
        '401':
          description: Unauthorized; Invalid Token
            (ìœ íš¨í•˜ì§€ ì•Šì€ refresh tokenìœ¼ë¡œ ì¬ë°œê¸‰ ì‹œë„)
  /group:
    get:
      summary: Get Groups
      tags:
        - group
      description: |
        ê³µê°œë¡œ ì„¤ì •ëœ ê·¸ë£¹ì˜ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
      parameters:
        - $ref: '#/components/parameters/cursor'
        - $ref: '#/components/parameters/take'
      responses:
        '200':
          description: Succeed
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: number
                  groupName:
                    type: string
                  description:
                    type: string
                  memberNum:
                    type: number
                    description: ê·¸ë£¹ì˜ ì´ ë©¤ë²„ ìˆ˜
        '400':
          description: Bad Request; Invalid Cursor
  /group/joined:
    get:
      summary: Get Joined Groups
      tags:
        - group
      description: |
        ê°€ì…í•œ ê·¸ë£¹ì˜ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
      security:
        - bearer: []
      responses:
        '200':
          description: Succeed
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: number
                  groupName:
                    type: string
                  description:
                    type: string
                  memberNum:
                    type: number
                    description: ê·¸ë£¹ì˜ ì´ ë©¤ë²„ ìˆ˜
                  isGroupLeader:
                    type: boolean
                    description: ê·¸ë£¹ ë¦¬ë” ì—¬ë¶€
  /group/{groupId}:
    get:
      summary: Get Group
      tags:
        - group
      description: |
        ê·¸ë£¹ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
        ìš”ì²­ëœ ê·¸ë£¹ì— ëŒ€í•œ ê°€ì… ì—¬ë¶€ì— ë”°ë¼ ì‘ë‹µì´ ë‹¬ë¼ì§ì— ìœ ì˜í•˜ì„¸ìš”.
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: number
          example: 4
      security:
        - bearer: []
      responses:
        '200 (joined)':
          description: Succeed on Retrieving Joined Group
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: number
                  groupName:
                    type: string
                  description:
                    type: string
                  isJoined:
                    type: boolean
                    description: ê·¸ë£¹ ê°€ì… ì—¬ë¶€
                    default: true
                  isGroupLeader:
                    type: boolean
                    description: ê·¸ë£¹ ë¦¬ë” ì—¬ë¶€
        '200 (not joined)':
          description: Succeed on Retrieving Not Joined Group
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: number
                  groupName:
                    type: string
                  description:
                    type: string
                  allowJoin:
                    type: boolean
                    description: ê·¸ë£¹ ê°€ì… í—ˆìš© ì—¬ë¶€
                  isJoined:
                    type: boolean
                    description: ê·¸ë£¹ ê°€ì… ì—¬ë¶€
                    default: false
                  memberNum:
                    type: string
                    description: ë©¤ë²„ ìˆ˜
                  leaders:
                    type: array
                    items:
                      type: string
                    description: ê·¸ë£¹ ë¦¬ë”ì˜ username ëª©ë¡
        '404':
          description: Not Found; Group Not Found
  /group/invite/{invitation}:
    get:
      summary: Get Invited Group
      tags:
        - group
      description: |
        ì´ˆëŒ€ ì½”ë“œë¡œ ê·¸ë£¹ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
        ì´ˆëŒ€ëœ ê·¸ë£¹ì— ëŒ€í•œ ê°€ì… ì—¬ë¶€ì— ë”°ë¼ ì‘ë‹µì´ ë‹¬ë¼ì§ì— ìœ ì˜í•˜ì„¸ìš”.
      parameters:
        - name: invitation
          in: path
          required: true
          schema:
            type: string
          example: fff000
          description: ì´ˆëŒ€ ì½”ë“œ
      security:
        - bearer: []
      responses:
        '200 (joined)':
          description: Succeed on Retrieving Joined Group
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: number
                  groupName:
                    type: string
                  description:
                    type: string
                  isJoined:
                    type: boolean
                    description: ê·¸ë£¹ ê°€ì… ì—¬ë¶€
                    default: true
                  isGroupLeader:
                    type: boolean
                    description: ê·¸ë£¹ ë¦¬ë” ì—¬ë¶€
        '200 (not joined)':
          description: Succeed on Retrieving Not Joined Group
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: number
                  groupName:
                    type: string
                  description:
                    type: string
                  allowJoin:
                    type: boolean
                    description: ê·¸ë£¹ ê°€ì… í—ˆìš© ì—¬ë¶€
                  isJoined:
                    type: boolean
                    description: ê·¸ë£¹ ê°€ì… ì—¬ë¶€
                    default: false
                  memberNum:
                    type: string
                    description: ë©¤ë²„ ìˆ˜
                  leaders:
                    type: array
                    items:
                      type: string
                    description: ê·¸ë£¹ ë¦¬ë”ì˜ username ëª©ë¡
        '404':
          description: Not Found; Invalid Invitation
            (ì˜ëª»ëœ ì´ˆëŒ€ ì½”ë“œ ì…ë ¥)
  /group/{groupId}/members:
    get:
      summary: Get Group Members
      tags:
        - group
      description: |
        ê·¸ë£¹ ë©¤ë²„ë“¤ì˜ username ëª©ë¡ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: number
          example: 4
      security:
        - bearer: []
      responses:
        '200':
          description: Succeed
          content:
            application/json:
              schema:
                type: array
                items:
                  - type: string
                description: username ëª©ë¡
        '403':
          description: Forbidden; Forbidden Resource
            (ê°€ì…ë˜ì§€ ì•Šì€ ê·¸ë£¹ì— ëŒ€í•œ ìƒì„¸ ì¡°íšŒ ì‹œë„)
  /group/{groupId}/leaders:
    get:
      summary: Get Group Leaders
      tags:
        - group
      description: |
        ê·¸ë£¹ ë¦¬ë”ë“¤ì˜ username ëª©ë¡ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: number
          example: 4
      security:
        - bearer: []
      responses:
        '200':
          description: Succeed
          content:
            application/json:
              schema:
                type: array
                items:
                  - type: string
                description: username ëª©ë¡
        '403':
          description: Forbidden; Forbidden Resource
            (ê°€ì…ë˜ì§€ ì•Šì€ ê·¸ë£¹ì— ëŒ€í•œ ìƒì„¸ ì¡°íšŒ ì‹œë„)
  /group/{groupId}/join:
    post:
      summary: Join Group
      tags:
        - group
      description: |
        ê·¸ë£¹ì— ê°€ì…ì„ ìš”ì²­í•©ë‹ˆë‹¤.
        ê°€ì…í•˜ë ¤ëŠ” ê·¸ë£¹ì˜ ìŠ¹ì¸ í•„ìš” ì—¬ë¶€, ì´ˆëŒ€ í•„ìš” ì—¬ë¶€ ë“±ì— ë”°ë¼ ì‘ë‹µì´ ë‹¬ë¼ì§ì— ìœ ì˜í•˜ì„¸ìš”.

        ### Approval Required Groups
        - ê°€ì… ì‹œ ê·¸ë£¹ ë¦¬ë”ì˜ ìŠ¹ì¸ì´ í•„ìš”í•œ ê·¸ë£¹ì˜ ê²½ìš°, ìš”ì²­ì´ ì„±ê³µí•˜ë”ë¼ë„ ê°€ì…ì´ ì™„ë£Œë˜ì§€ ì•Šìœ¼ë©° ë¦¬ë”ì˜ ì‘ë‹µì„ ê¸°ë‹¤ë ¤ì•¼ í•©ë‹ˆë‹¤.

        ### Invitation Required Groups
        - ì´ˆëŒ€ ì½”ë“œë¡œ ì¡°íšŒí•œ ê·¸ë£¹ì— ê°€ì…í•˜ë ¤ë©´ ì˜¬ë°”ë¥¸ ì´ˆëŒ€ ì½”ë“œë¥¼ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê²¨ì£¼ì–´ì•¼ ê°€ì… ìš”ì²­ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤.
      security:
        - bearer: []
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: number
          example: 4
        - name: invitation
          required: false
          in: query
          schema:
            type: string
          description: ì´ˆëŒ€ ì½”ë“œ
          example: fff000
      responses:
        '200':
          description: Succeed on Joining Group
          content:
            application/json:
              schema:
                type: object
                properties:
                  isJoined:
                    type: boolean
                    default: true
                  userId:
                    type: number
                  groupId:
                    type: number
                  isGroupLeader:
                    type: boolean
                    description: |
                      ê·¸ë£¹ ë¦¬ë” ì—¬ë¶€

                      Admin/SuperAdminì˜ ê°€ì… ì‹œ ê·¸ë£¹ ë¦¬ë”ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.
                    default: false
                  createTime:
                    type: string
                    format: date-time
                  updateTime:
                    type: string
                    format: date-time
        '200 (requested)':
          description: Succeed on Requesting Group Join Approval
          content:
            application/json:
              schema:
                type: object
                properties:
                  isJoined:
                    type: boolean
                    default: false
                  userGroupData:
                    type: object
                    properties:
                      userId:
                        type: number
                      groupId:
                        type: number
        '403':
          description: Forbidden; Invalid invitation
            (ì˜ëª»ëœ ì´ˆëŒ€ ì½”ë“œë¡œ ê°€ì… ìš”ì²­)
        '404':
          description: Not Found; Group Not Found
        '409':
          description: |
            - Conflict; Already joined this group (ì´ë¯¸ ê°€ì…ëœ ê·¸ë£¹ì— ëŒ€í•œ ê°€ì… ì‹œë„)
            - Conflict; Already requested to join this group (ì´ë¯¸ ê°€ì… ìš”ì²­ëœ ê·¸ë£¹ì— ëŒ€í•œ ê°€ì… ì‹œë„)
  /group/{groupId}/leave:
    delete:
      summary: Leave Group
      tags:
        - group
      description: |
        ê·¸ë£¹ì„ íƒˆí‡´í•©ë‹ˆë‹¤.
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: number
          example: 4
      security:
        - bearer: []
      responses:
        '200':
          description: Succeed
          content:
            application/json:
              schema:
                type: object
                properties:
                  userId:
                    type: number
                  groupId:
                    type: number
                  isGroupLeader:
                    type: boolean
                  createTime:
                    type: string
                    format: date-time
                  updateTime:
                    type: string
                    format: date-time
        '403':
          description: Forbidden; Forbidden Resource
            (ê°€ì…ë˜ì§€ ì•Šì€ ê·¸ë£¹ì— ëŒ€í•œ íƒˆí‡´ ì‹œë„)

components:
  securitySchemes:
    bearer:
      scheme: bearer
      bearerFormat: JWT
      type: http
  parameters:
    cursor:
      name: cursor
      description: |
        ê°€ì ¸ì˜¬ ì•„ì´í…œì˜ ê¸°ì¤€ì 

        ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ìë™ìœ¼ë¡œ ì²«ë²ˆì§¸ ì•„ì´í…œë¶€í„° ë°˜í™˜í•˜ë©°, ê°’ì´ ì–‘ìˆ˜ê°€ ì•„ë‹ˆë©´ 400 ì—ëŸ¬ê°€ ë°˜í™˜ë©ë‹ˆë‹¤.
      required: false
      in: query
      schema:
        type: number
      example: 3
    take:
      name: take
      description: |
        ê°€ì ¸ì˜¬ ì•„ì´í…œì˜ ìµœëŒ€ ê°œìˆ˜

        ì–‘ìˆ˜ë©´ `cursor` ë’¤ì˜ ì•„ì´í…œì„, ìŒìˆ˜ë©´ `cursor` ì•ì˜ ì•„ì´í…œì„ ì ˆëŒ“ê°’ë§Œí¼ ë°˜í™˜í•©ë‹ˆë‹¤.
      required: true
      in: query
      schema:
        type: number
      example: 5
  schemas:
    LoginUserDto:
      type: object
      properties:
        username:
          type: string
          example: admin
        password:
          type: string
          example: Adminadmin
      required:
        - username
        - password
    NewPasswordDto:
      type: object
      properties:
        newPassword:
          type: string
      required:
        - newPassword
    SignUpDto:
      type: object
      properties:
        username:
          type: string
        password:
          type: string
        email:
          type: string
        realName:
          type: string
          pattern: /^[a-zA-Z\s]+$/
      required:
        - username
        - password
        - email
        - realName
    WithdrawalDto:
      type: object
      properties:
        password:
          type: string
      required:
        - password
    UpdateUserEmailDto:
      type: object
      properties:
        email:
          type: string
      required:
        - email
    UpdateUserProfileRealNameDto:
      type: object
      properties:
        realName:
          type: string
      required:
        - realName
    UserEmailDto:
      type: object
      properties:
        email:
          type: string
      required:
        - email
    EmailAuthenticationPinDto:
      type: object
      properties:
        pin:
          type: string
        email:
          type: string
      required:
        - pin
        - email
    ProblemsResponseDto:
      type: object
      properties:
        id:
          type: number
        title:
          type: string
        difficulty:
          type: object
        submissionCount:
          type: number
        acceptedRate:
          type: number
        tags:
          type: object
      required:
        - id
        - title
        - difficulty
        - submissionCount
        - acceptedRate
        - tags
    ProblemResponseDto:
      type: object
      properties:
        id:
          type: number
        title:
          type: string
        description:
          type: string
        inputDescription:
          type: string
        outputDescription:
          type: string
        hint:
          type: string
        languages:
          type: array
          items:
            type: object
        timeLimit:
          type: number
        memoryLimit:
          type: number
        difficulty:
          type: object
        source:
          type: array
          items:
            type: string
        inputExamples:
          type: array
          items:
            type: string
        outputExamples:
          type: array
          items:
            type: string
      required:
        - id
        - title
        - description
        - inputDescription
        - outputDescription
        - hint
        - languages
        - timeLimit
        - memoryLimit
        - difficulty
        - source
        - inputExamples
        - outputExamples
    RelatedProblemsResponseDto:
      type: object
      properties:
        id:
          type: string
        problemId:
          type: number
        title:
          type: string
      required:
        - id
        - problemId
        - title
    RelatedProblemResponseDto:
      type: object
      properties:
        id:
          type: string
        problem:
          type: object
      required:
        - id
        - problem
    Snippet:
      type: object
      properties:
        id:
          type: number
        text:
          type: string
        locked:
          type: boolean
      required:
        - id
        - text
        - locked
    CreateSubmissionDto:
      type: object
      properties:
        code:
          type: array
          items:
            $ref: '#/components/schemas/Snippet'
        language:
          type: object
      required:
        - code
        - language
