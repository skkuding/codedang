global:
  image: {}

deploymentMode: SingleBinary
loki:
  auth_enabled: false
  commonConfig:
    replication_factor: 1
  limits_config:
    retention_period: 2160h # 90 days
  compactor:
    retention_enabled: true
    delete_request_store: s3
  ring:
    kvstore:
      store: inmemory
  storage:
    bucketNames:
      chunks: loki
      ruler: loki
    type: s3
    s3:
      endpoint: http://minio.monitoring-minio.svc.cluster.local:80
      accessKeyId: ${AWS_ACCESS_KEY_ID}
      secretAccessKey: ${AWS_SECRET_ACCESS_KEY}
      s3ForcePathStyle: true
      insecure: true
  schemaConfig:
    configs:
      - from: 2025-08-15
        object_store: s3
        store: tsdb
        schema: v13
        index:
          prefix: loki_index_
          period: 24h
  distributor:
    otlp_config:
      default_resource_attributes_as_index_labels:
        # these keys will be indexed
        ['service.name', 'service.version', 'service.environment']
  storage_config:
    tsdb_shipper:
      query_ready_num_days: 90

singleBinary:
  extraArgs:
    - '--config.expand-env=true'
  extraEnv:
    - name: AWS_ACCESS_KEY_ID
      valueFrom:
        secretKeyRef:
          name: monitoring-user
          key: CONSOLE_ACCESS_KEY
    - name: AWS_SECRET_ACCESS_KEY
      valueFrom:
        secretKeyRef:
          name: monitoring-user
          key: CONSOLE_SECRET_KEY

gateway:
  enabled: false

# Disabled - using central monitoring-minio instead
minio:
  enabled: false

# Fix canary URL bug (trailing dot before port)
lokiCanary:
  enabled: true
  lokiurl: loki.monitoring-loki.svc.cluster.local:3100
